name: Install Tools
runs:
  using: "composite"
  steps:
    - name: Install ASDF and Terraform
      run: |
        git config --global advice.detachedHead false
        git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.14.0
        echo ". $HOME/.asdf/asdf.sh" >> $HOME/.bashrc
        echo ". $HOME/.asdf/completions/asdf.bash" >> $HOME/.bashrc
        . "$HOME/.asdf/asdf.sh"
        . "$HOME/.asdf/completions/asdf.bash"
        asdf plugin-add terraform https://github.com/asdf-community/asdf-hashicorp.git
        TERRAFORM_VERSION=$(asdf latest terraform)
        asdf install terraform $TERRAFORM_VERSION
        asdf local terraform $TERRAFORM_VERSION
      shell: bash
    - name: Install .NET
      run: |
        sudo apt-get update && \
        sudo apt-get install -y dotnet-sdk-8.0
      shell: bash
    - name: Check installed versions
      run: |
        . "$HOME/.asdf/asdf.sh"
        . "$HOME/.asdf/completions/asdf.bash"
        terraform --version
        docker --version
        dotnet --version
      shell: bash
